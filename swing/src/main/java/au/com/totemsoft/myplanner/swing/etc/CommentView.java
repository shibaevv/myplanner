/*
 * CommentView.java
 *
 * Created on 13 November 2001, 12:36
 */

package au.com.totemsoft.myplanner.swing.etc;

import au.com.totemsoft.myplanner.etc.Comment;
import au.com.totemsoft.myplanner.service.ClientService;
import au.com.totemsoft.swing.SwingUtil;

public class CommentView extends javax.swing.JComponent {

    private Integer linkObjectTypeID;

    private Comment comment;

    private static ClientService clientService;
    public static void setClientService(ClientService clientService) {
        CommentView.clientService = clientService;
    }

    /** Creates new form CommentView */
    public CommentView() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    private void initComponents() {
        jScrollPane = new javax.swing.JScrollPane();
        jTextArea = new javax.swing.JTextArea();

        setLayout(new javax.swing.BoxLayout(this, javax.swing.BoxLayout.Y_AXIS));

        setBorder(new javax.swing.border.TitledBorder("Comment"));
        jTextArea.setLineWrap(true);
        jTextArea.setMargin(new java.awt.Insets(5, 5, 5, 5));
        jScrollPane.setViewportView(jTextArea);

        add(jScrollPane);

    }

    // Variables declaration - do not modify
    private javax.swing.JScrollPane jScrollPane;

    private javax.swing.JTextArea jTextArea;

    // End of variables declaration

    /**
     * Viewable interface
     */
    public Integer getObjectType() {
        return Comment.OBJECT_TYPE_ID;
    }

    public void updateView(au.com.totemsoft.myplanner.service.PersonService person)
            throws au.com.totemsoft.myplanner.api.ServiceException {
        if (person == null)
            person = clientService;

        comment = person.getComment(linkObjectTypeID);
        if (comment == null)
            clearView();
        else
            jTextArea.setText(comment.getCommentText());
    }

    public void saveView(au.com.totemsoft.myplanner.service.PersonService person)
            throws au.com.totemsoft.myplanner.api.ServiceException,
            au.com.totemsoft.myplanner.api.InvalidCodeException {
        if (person == null)
            person = clientService;

        if (comment == null) {
            comment = person.getComment(linkObjectTypeID);
            if (comment == null)
                comment = new Comment(clientService.getId());
        }

        comment.setCommentText(jTextArea.getText());

        person.setComment(linkObjectTypeID, comment);

        // this is not a independent view (will be conained in another view all
        // the time)
        // person.save();
    }

    public void clearView() {
        SwingUtil.clear(this);
        // jTextArea.setText( null );
    }

    public Object getObject() {
        return comment;
    }

    public void setObject(Object value) {
        comment = (Comment) value;
    }

    /**
     * get/set
     */
    public Integer getLinkObjectTypeID() {
        return linkObjectTypeID;
    }

    public void setLinkObjectTypeID(Integer value) {
        linkObjectTypeID = value;
    }

}
